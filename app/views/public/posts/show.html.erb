posts_controller/show.html.erb<br>

<!-- 投稿画像を表示 -->
<% if @post.images.attached? %>
  <% @post.images.each do |image| %>
    <%= image_tag image, size: "150x150" %> <br>
  <% end %>
<% end %>

カテゴリー：　<%= @post.category_i18n %><br>
都道府県　：　<%= @post.prefecture_i18n %><br>
市町村　　：　<%= @post.city %><br>
スポット名：　<%= @post.spot_name %><br>
旅のメモ　：　<%= @post.body %><br><br>

<!-- 管理者 と 投稿者 のみ[編集]と[削除]を表示 -->
<% if member_signed_in? && current_member.id == @post.member_id || admin_signed_in? %>
  <%= link_to "編集する",edit_post_path(@post.id) %>
  <%= link_to "削除する", post_path(@post.id), method: :delete %><br><br>
<% end %>

<!-- コメント機能　ここから -->
コメント件数：<%= @post.post_comments.count %><br>
<% @post.post_comments.each do |post_comment| %>
  <%= post_comment.created_at.strftime('%Y/%m/%d') %>
  <%= post_comment.member.user_name %><br>
  <%= post_comment.body %><br><br>
  <% if post_comment.member == current_member %>
    <%= link_to "削除", post_post_comment_path(post_comment.post, post_comment), method: :delete %><br>
  <% end %>
<% end %>

<!-- ログイン中会員のみコメント投稿フォームを表示 -->
<% if member_signed_in? %>
  <%= form_with(model:[@post, @post_comment], local: true) do |f| %>
    <%= f.text_area :body, placeholder: "コメントをここに" %><br>
    <%= f.submit "送信する" %><br><br>
  <% end %>
<% end %>
<!-- コメント機能　ここまで -->

<!-- いいね機能　ここから　※ログイン中会員のみ いいね可 -->
<% if member_signed_in? %>
  <!-- いいね機能 -->
  <% unless @post.liked_by?(current_member) %>
    <%= link_to post_post_likes_path(@post), method: :post do %>
      ♡<%= @post.post_likes.count %> いいね
    <% end %>
  <!-- いいね削除機能 -->
  <% else %>
    <%= link_to post_post_likes_path(@post), method: :delete do %>
      ♥<%= @post.post_likes.count %> いいね
    <% end %>
  <% end %>
<!-- 管理者 と ログインしていない場合はいいね数のみ表示 -->
<% else %>
  ♡<%= @post.post_likes.count %> いいね
<% end %>
<!-- いいね機能　ここまで -->


<!-- Google Maps機能　ここから -->

<h2>gmap</h2>
<!-- form_withはデフォルトでremote: trueの挙動になります -->

<%= form_with url: map_request_path, method: :get do |f|%>
  <%= f.text_field :city %>
  <%= f.submit '地図表示' %>
<% end %>

<div id="map">
</div>

<style>
#map{
  height: 400px;
}
</style>

<script>
  let mapInstance //この変数はmap.js.erbでも使うのでタイプミスに注意

  function initMap(){
    mapInstance = new google.maps.Map(document.getElementById('map'), {
    center: {lat: -34.397, lng: 150.644},
    zoom: 8
    });
  }
</script>
<script src="https://maps.googleapis.com/maps/api&/js?key=<%=ENV['GOOGLE_MAP_KEY']%>&callback=initMap" async defer></script>



<!-- Google Maps機能　ここまで -->